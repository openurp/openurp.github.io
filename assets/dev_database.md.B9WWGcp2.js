import{_ as l,c as i,o as e,ae as t}from"./chunks/framework.DNjB2eFM.js";const _=JSON.parse('{"title":"数据库对象结构设计策略","description":"","frontmatter":{},"headers":[],"relativePath":"dev/database.md","filePath":"dev/database.md"}'),r={name:"dev/database.md"};function o(d,a,n,s,h,u){return e(),i("div",null,[...a[0]||(a[0]=[t('<h1 id="数据库对象结构设计策略" tabindex="-1">数据库对象结构设计策略 <a class="header-anchor" href="#数据库对象结构设计策略" aria-label="Permalink to &quot;数据库对象结构设计策略&quot;">​</a></h1><h2 id="一、数据库总体要求" tabindex="-1">一、数据库总体要求 <a class="header-anchor" href="#一、数据库总体要求" aria-label="Permalink to &quot;一、数据库总体要求&quot;">​</a></h2><h3 id="_1-1-总体要求" tabindex="-1">1.1 总体要求 <a class="header-anchor" href="#_1-1-总体要求" aria-label="Permalink to &quot;1.1 总体要求&quot;">​</a></h3><ol><li>数据库采用了PostgreSQL 9以上,Maria/MySQL 5以上，Oracle 10g以上的版本</li><li>对于维护十年以上的数据，默认表空间最少要4G</li></ol><h3 id="_1-2-对象命名约定和规则" tabindex="-1">1.2 对象命名约定和规则 <a class="header-anchor" href="#_1-2-对象命名约定和规则" aria-label="Permalink to &quot;1.2 对象命名约定和规则&quot;">​</a></h3><ol><li>数据库中表、视图、索引采用英文及其缩写，尽量避免使用汉语拼音首字母缩写，方便查找，避免猜测。</li><li>按照模块的前缀组织表和视图的命名</li><li>使用复数命名表明和视图名，例如Students表示student，People表示person，没有特殊的划分不许要增加_T或者T_之类的前后缀。</li><li>数据库列命名上,采用xxx_at表示时间和日期,xx_on表示日期，例如start_on表示开始日期</li><li>数据库序列采用seq_作为前缀，默认后续为表名，表示对应的表使用的序列</li><li>索引采用idx_作为前缀</li><li>所有数据库对象的命名使用为小写字母。</li><li>所有数据库对象命名长度一般不能超过30字符。</li></ol><h2 id="二、数据id类型设计和分区" tabindex="-1">二、数据ID类型设计和分区 <a class="header-anchor" href="#二、数据id类型设计和分区" aria-label="Permalink to &quot;二、数据ID类型设计和分区&quot;">​</a></h2><h3 id="_2-1-id-类型" tabindex="-1">2.1 ID 类型 <a class="header-anchor" href="#_2-1-id-类型" aria-label="Permalink to &quot;2.1 ID 类型&quot;">​</a></h3><p>OpenURP系统支持数字和字符串两种ID类型。数字ID的生成策略如下：</p><ul><li>auto_increment 支持自增长,适用于缓慢增长的数据，基于next_id(&#39;{table_name}&#39;)方法生成。</li><li>code 支持将代码直接转换成数字作为ID，这种策略适用于基础代码、字典类数据。</li><li>有时间特征数据采用date_id+seq,或者date_time_id+seq</li></ul><h3 id="_2-2-数据分区策略" tabindex="-1">2.2 数据分区策略 <a class="header-anchor" href="#_2-2-数据分区策略" aria-label="Permalink to &quot;2.2 数据分区策略&quot;">​</a></h3><p>一旦数据量过大，考虑数据分区的策略。Openurp在部署阶段支持按照学年进行拆分的方法，而不是按照按照ID进行划分的方式， 例如成绩、选课记录等，这些表需要有学年字段(int)，方可进行拆分。数据分区时，可以在schema内部建立新表，然后建立合适的路由即可。 如果分区牵涉的数据表较多，可以建立具有时间阶梯的schema组进行处理。这里以教务为例。</p><p>如果以学年划分数据比较合适，教务的很多表都需要进行分表切分，因此我们建立如下策略</p><ul><li>his_2015 表示2011～2012到2015-2020五个学年的数据</li><li>his_2020 表示2016～2016到2020-2021五个学年的数据</li></ul><p>尝试以每五年做一次数据切分和归档处理。</p><p>数据库分表策略尽量按照数据库支持的技术进行构建。例如在Postgresql中支持表继承和分区技术。</p><h2 id="三、模块命名设计" tabindex="-1">三、模块命名设计 <a class="header-anchor" href="#三、模块命名设计" aria-label="Permalink to &quot;三、模块命名设计&quot;">​</a></h2><p>整个urp系统采用模块式的布局进行构建。由于涉及到教务、学籍、教学质量等众多的业务方面，因此如何这些模块，防止命名冲突，以及增强可维护性等都带来了挑战。虽然整个urp系统可以碎片化部署，但是整体上代码会更多的考虑兼容性。因此不会选择随机的字符串作为每个模块的名称，而是给每个模块在固定的命名空间下，一个固定的不冲突的名称。这样的思路在restful service url设计和数据库schema规划上会更好的遵循。 每个模块下需要设置一个基础模块base,该模块是将整个业务的基础部分进行归纳和精简，其他业务依赖该业务时，大多依赖的公约数部分。</p><p>采用大尺度划分为7业务范围，以下列举这些业务的命名空间规范：</p><ul><li>code 表示国标和行业标准</li><li>base 表示基础模块(人员、场所、校历、公共代码标准)</li><li>edu(education) 表示教学教务、学生培养、学生教育相关的业务</li><li>std(student) 表示学生服务相关业务</li><li>degree 表示学位、论文相关</li><li>qos(qos) 表示教学质量</li><li>prac(practice) 表示实践教学</li></ul><h3 id="_3-1-教学-edu" tabindex="-1">3.1 教学(Edu) <a class="header-anchor" href="#_3-1-教学-edu" aria-label="Permalink to &quot;3.1 教学(Edu)&quot;">​</a></h3><ul><li>clazz 表示排课、选课</li><li>exam 表示考务</li><li>program 表示培养方案</li><li>exam 表示考务</li><li>attance 表示考勤</li><li>project 表示教学项目管理</li><li>... 其他(离校、毕业、迎新、就业等相关事务)</li></ul><h3 id="_3-2-学生信息-std" tabindex="-1">3.2 学生信息(Std) <a class="header-anchor" href="#_3-2-学生信息-std" aria-label="Permalink to &quot;3.2 学生信息(Std)&quot;">​</a></h3><ul><li>alter 表示学籍异动</li><li>award 表示综合评定、奖学金、助学金业务</li><li>exhcnage 表示校外学习</li><li>fee 表示收费信息</li><li>graduation 表示毕业信息</li><li>info 表示学生信息</li><li>register 表示注册报到</li><li>transfer 表示转专业</li></ul><h3 id="_3-3-教学质量-qos" tabindex="-1">3.3 教学质量(QoS) <a class="header-anchor" href="#_3-3-教学质量-qos" aria-label="Permalink to &quot;3.3 教学质量(QoS)&quot;">​</a></h3><ul><li>evaluation 表示课程评价</li></ul><h3 id="_3-4-实践教学-prac" tabindex="-1">3.4 实践教学(Prac) <a class="header-anchor" href="#_3-4-实践教学-prac" aria-label="Permalink to &quot;3.4 实践教学(Prac)&quot;">​</a></h3><ul><li>innovation 表示大学生创新创业</li></ul><h3 id="四、其他维护说明" tabindex="-1">四、其他维护说明 <a class="header-anchor" href="#四、其他维护说明" aria-label="Permalink to &quot;四、其他维护说明&quot;">​</a></h3><ul><li>不要在数据库中建立过多的临时表，临时表应建立在tmp schema下。</li><li>定期备份数据库，做好恢复准备。</li><li>定期监视sql语句历史，为优化做准备。</li><li>对经常进行读写，并且数据量较大的表格进行重组。</li><li>本设计未在MS SQL Server，DB2等系统上进行测试过。</li></ul>',30)])])}const p=l(r,[["render",o]]);export{_ as __pageData,p as default};
